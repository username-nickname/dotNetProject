## üõ†Ô∏è –ö–∞–∫ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ü—Ä–æ–µ–∫—Ç

–ù—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞–∫–∞—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫ –≤–µ—Å—å –∫–æ–¥ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —É–∂–µ –ª–µ–∂–∞—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

1) git clone https://github.com/username-nickname/dotNetProject.git
2) dotnet tool install --global dotnet-ef
3) dotnet ef database update --project Infrastructure --startup-project Project.Api
4) dotnet run --project Project.Api

## üõ†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç —Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —á–µ—Ç—ã—Ä–µ —Å–ª–æ—è. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤—Å–µ–≥–¥–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–Ω—É—Ç—Ä—å

1) Domain: –Ø–¥—Ä–æ –±–∏–∑–Ω–µ—Å–∞. –°–æ–¥–µ—Ä–∂–∏—Ç —Å—É—â–Ω–æ—Å—Ç–∏ (User), –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã) –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã (IUserRepository). –ü–æ–ª—è CreatedAt / UpdatedAt —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
2) Application: –°–ª–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –°–æ–¥–µ—Ä–∂–∏—Ç —Å–µ—Ä–≤–∏—Å—ã (UserService, AuthService), DTO –∏ FluentValidation. –£–ø—Ä–∞–≤–ª—è–µ—Ç –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–µ–º (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è).
3) Infrastructure: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è. –°–æ–¥–µ—Ä–∂–∏—Ç AppDbContext (EF Core), —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —Ö–µ—à–µ—Ä—ã (BCrypt) –∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–æ–∫–µ–Ω–æ–≤ (JWT).
4) Project.Api: –°–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ DI –∏ Middleware.

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏

1) ORM: EF Core. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLServer) —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è–º–∏, —Å—É—â–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Change Tracking (–±–µ–∑ —è–≤–Ω—ã—Ö Update(), –æ–Ω —Å–∞–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ —Å—É—â–Ω–æ—Å—Ç—å –±—ã–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –≤ –ø–∞–º—è—Ç–∏).
2) –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: JWT Bearer Token. –¢–æ–∫–µ–Ω –≤—ã–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ Microsoft.AspNetCore.Authentication.JwtBearer –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
3) –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –¢–æ–∫–µ–Ω–∞: Token Versioning (Middleware). –ü—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è —Ç–æ–∫–µ–Ω–∞ –≤ –ë–î –≤ —Ç–∞–±–ª–∏—Ü–µ users. –ö–∞—Å—Ç–æ–º–Ω—ã–π Middleware –æ—Ç–∫–ª–æ–Ω—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401, –µ—Å–ª–∏ –≤–µ—Ä—Å–∏—è —Ç–æ–∫–µ–Ω–∞ –≤ –ë–î —É —é–∑–µ—Ä–∞ ,–±–æ–ª—å—à–µ —á–µ–º –≤ –ø–µ—Ä–µ–¥–∞–Ω–æ–º —Ç–æ–∫–µ–Ω–µ)
4) –í–∞–ª–∏–¥–∞—Ü–∏—è: FluentValidation. –í—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (—Ñ–æ—Ä–º–∞—Ç, —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å Email) –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ DTO-–≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã. (–°–ª–æ–π Application , Validators)
5) –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫: –ì–ª–æ–±–∞–ª—å–Ω—ã–π ApiExceptionFilter (Project.Api/Filters). –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –ª–æ–≤–∏—Ç –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–¥–∏–Ω—ã–π JSON-–æ—Ç–≤–µ—Ç –≤ —Å—Ç–∏–ª–µ ApiResponse<T> (400, 404, 500) (Application/DTO/Contracts).

## –°—É—â–Ω–æ—Å—Ç–∏ –∏ –õ–æ–≥–∏–∫–∞ (Domain)
1) –°—É—â–Ω–æ—Å—Ç–∏ (User, Role): –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –º–µ—Ç–æ–¥—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, user.UpdateName(), user.ChangePassword()) –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º).
2) –ê—É–¥–∏—Ç: –ü–æ–ª—è CreatedAt –∏ UpdatedAt –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ AppDbContext (Infrastructure), –∞ –Ω–µ –≤—Ä—É—á–Ω—É—é –≤ —Å—É—â–Ω–æ—Å—Ç—è—Ö.

## –¢–æ—á–∫–∏ –í—Ö–æ–¥–∞ Controllers (Project.Api)
–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ Project.Api –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ–Ω–∫–∏–µ –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –¥–≤–µ –≥–ª–∞–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:
1) –ü—Ä–∏–µ–º/–û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP: –ü—Ä–∏–Ω–∏–º–∞—é—Ç –¥–∞–Ω–Ω—ã–µ (DTO) –∏–∑ JSON –∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (userId) –∏–∑ —Ç–æ–∫–µ–Ω–∞.
2) –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –í—ã–∑—ã–≤–∞—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –≤ Application Service.

–û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫: –í—Å–µ –±–ª–æ–∫–∏ try-catch —É–¥–∞–ª–µ–Ω—ã. –û—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, UserNotFoundException, ValidationException) –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –ì–ª–æ–±–∞–ª—å–Ω—ã–º –§–∏–ª—å—Ç—Ä–æ–º ApiExceptionFilter (Project.Api/Filters/), –∫–æ—Ç–æ—Ä—ã–π –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –≤ –µ–¥–∏–Ω—ã–π JSON-–æ—Ç–≤–µ—Ç –≤ –Ω–∞—à–µ–º —Å—Ç–∏–ª–µ (ApiResponse).
*** –û—Ç–≤–µ—Ç—ã –æ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –≤—ã–∑—ã–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ ApiControllerBase (–ù–∞–ø—Ä–∏–º–µ—Ä: return OkResponse("Register successfully");). –ú–µ—Ç–æ–¥ OkResponse –ª–µ–∂–∏—Ç –≤ ApiControllerBase.

## JWT –∏ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
1) –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¢–æ–∫–µ–Ω–∞: –í –º–µ—Ç–æ–¥–µ AuthService.Login(), –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è ITokenGenerator (–∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤ Infrastructure). –¢–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏–º—è –µ–≥–æ —Ä–æ–ª–∏ (Admin –∏–ª–∏ User) –∫–∞–∫ Claims.
2) –ü—Ä–æ–≤–µ—Ä–∫–∞ –¢–æ–∫–µ–Ω–∞: Middleware app.UseAuthentication() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å —Ç–æ–∫–µ–Ω–∞.
3) –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –¢–æ–∫–µ–Ω–∞: –ù–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π Middleware JwtTokenVersionMiddleware –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –û–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é —Ç–æ–∫–µ–Ω–∞ (tver Claim) —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π –∏–∑ –ë–î. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–µ–Ω–∏–ª –ø–∞—Ä–æ–ª—å (TokenVersion –≤ –ë–î –≤—ã—Ä–æ—Å), —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è (401 Unauthorized).

## –†–æ—É—Ç—ã –∏ –ó–∞—â–∏—Ç–∞
–ú–∞—Ä—à—Ä—É—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É RESTful –∏ –∑–∞—â–∏—â–µ–Ω—ã –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏:

1) –ü—É–±–ª–∏—á–Ω—ã–µ: [AllowAnonymous] (–Ω–∞–ø—Ä–∏–º–µ—Ä, /api/login, /api/register).
2) –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ: [Authorize] (—Ç—Ä–µ–±—É–µ—Ç –ª—é–±–æ–π –≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω).
3) –° –ü—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–æ–ª–∏: [RoleAuthorize(RoleType.Student)] (—Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω —Å –∫–ª–µ–π–º–æ–º Role: Admin)


## API Endpoints

1) POST /api/register –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü—É–±–ª–∏—á–Ω—ã–π
2) POST /api/login	–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT Token.	–ü—É–±–ª–∏—á–Ω—ã–π
3) GET /api/user/{userId}	–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.	[Authorize(Roles = "Admin")]
4) PATCH /api/user/update	–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –ø—Ä–æ—Ñ–∏–ª—è.	[Authorize]
5) POST	/api/user/change-password	–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è (–∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã).	[Authorize]

## Responses
API –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–¥–∏–Ω—ã–π JSON-–∫–æ–Ω—Ç—Ä–∞–∫—Ç –≤ —Å—Ç–∏–ª–µ ApiResponse<T>:

1) –£—Å–ø–µ—Ö (200 OK): { "success": true, "message": "...", "data": {...} }
2) –û—à–∏–±–∫–∞ (400/404/500): { "success": false, "message": "...", "errors": [...] }

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –æ—Ç–≤–µ—Ç
